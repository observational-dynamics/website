<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar class="astro-bguv2lll"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Composite Multi-Agent Systems | My Docs</title><link rel="canonical"/><link rel="shortcut icon" href="/favicon.svg" type="image/svg+xml"/><meta name="generator" content="Astro v3.3.2"/><meta name="generator" content="Starlight v0.11.1"/><meta property="og:title" content="Composite Multi-Agent Systems"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description" content="Composite multi-agent systems. A composite multi-agent system is a collection of agents that work together to achieve a common goal. The agents can be homogeneous or heterogeneous, and can be trained independently or jointly. The agents can be trained using reinforceme"/><meta property="og:site_name" content="My Docs"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Composite Multi-Agent Systems"/><meta name="twitter:description" content="Composite multi-agent systems. A composite multi-agent system is a collection of agents that work together to achieve a common goal. The agents can be homogeneous or heterogeneous, and can be trained independently or jointly. The agents can be trained using reinforceme"/><meta name="description" content="Composite multi-agent systems. A composite multi-agent system is a collection of agents that work together to achieve a common goal. The agents can be homogeneous or heterogeneous, and can be trained independently or jointly. The agents can be trained using reinforceme"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg><svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg><svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg></template><link rel="stylesheet" href="/_astro/index.15b97c7f.css" />
<style>svg:where(.astro-c6vsoqas){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}
</style><script type="module" src="/_astro/hoisted.dbfb2330.js"></script></head><body class="astro-bguv2lll"><a href="#_top" class="astro-7q3lir66">Skip to content</a><div class="page sl-flex astro-vrdttmbt"><header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"><div class="sl-flex astro-kmkmnagf"><a href="/" class="site-title sl-flex astro-m46x6ez3"><span class="astro-m46x6ez3">My Docs</span></a></div><div class="sl-flex astro-kmkmnagf"><site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"><button data-open-modal disabled class="astro-v37mnknz"><svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg><span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span><svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg></button><dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"><div class="dialog-frame sl-flex astro-v37mnknz"><button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz">Cancel</button><div class="search-container astro-v37mnknz"><div id="starlight__search" class="astro-v37mnknz"></div></div></div></dialog></site-search></div><div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"><div class="sl-flex social-icons astro-kmkmnagf"><a href="https://github.com/withastro/starlight" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a></div><starlight-theme-select><label style="--sl-select-width: 6.25em" class="astro-4yphtoen"><span class="sr-only astro-4yphtoen">Select theme</span><svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg><select value="auto" class="astro-4yphtoen"><option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option></select><svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg></label></starlight-theme-select><script>
	StarlightThemeProvider.updatePickers();
</script></div></div></header><nav class="sidebar astro-vrdttmbt" aria-label="Main"><starlight-menu-button class="astro-jif73yzw"><button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"><svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg></button></starlight-menu-button><div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"><div class="sidebar-content sl-flex astro-vrdttmbt"><ul class="top-level astro-3ii7xxms"><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">Papers</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><a href="/papers/an-integrated-agent-perception-system-using-neural-models-and-simulation-environments/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">An Integrated Agent Perception System Using Neural Models And Simulation Environments</span></a></li><li class="astro-3ii7xxms"><a href="/papers/applying-od-circuits-to-optimize-neural-network-computing/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Applying Od Circuits To Optimize Neural Network Computing</span></a></li><li class="astro-3ii7xxms"><a href="/papers/applying-od-network-analysis-to-study-neural-network-information-flow/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Applying Od Network Analysis To Study Neural Network Information Flow</span></a></li><li class="astro-3ii7xxms"><a href="/papers/applying-od-stability-analysis-to-neural-network-training/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Applying Od Stability Analysis To Neural Network Training</span></a></li><li class="astro-3ii7xxms"><a href="/papers/architectural-principles-for-observational-dynamics-inspired-machine-learning/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Architectural Principles For Observational Dynamics Inspired Machine Learning</span></a></li><li class="astro-3ii7xxms"><a href="/papers/benchmarking-observational-dynamics-inspired-vs-traditional-machine-learning/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Benchmarking Observational Dynamics Inspired Vs Traditional Machine Learning</span></a></li><li class="astro-3ii7xxms"><a href="/papers/biased-signal-processing-with-property-preserving-hash-functions-a-novel-approach-to-document-clustering/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Biased Signal Processing With Property Preserving Hash Functions   A Novel Approach To Document Clustering</span></a></li><li class="astro-3ii7xxms"><a href="/papers/bridging-low-level-and-high-level-intelligence-using-od/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Bridging Low Level And High Level Intelligence Using Od</span></a></li><li class="astro-3ii7xxms"><a href="/papers/circuit-modeling-of-observational-dynamics/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Circuit Modeling Of Observational Dynamics</span></a></li><li class="astro-3ii7xxms"><a href="/papers/from-the-bulk-to-the-brane-quantum-fluctuations-consciousness-and-the-emergence-of-observable-phenomena/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">From The Bulk To The Brane   Quantum Fluctuations, Consciousness, And The Emergence Of Observable Phenomena</span></a></li><li class="astro-3ii7xxms"><a href="/papers/growing-neural-networks-fractal-tree-architectures-for-representation-learning/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Growing Neural Networks   Fractal Tree Architectures For Representation Learning</span></a></li><li class="astro-3ii7xxms"><a href="/papers/modeling-neural-networks-as-thermodynamic-systems-with-od/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Modeling Neural Networks As Thermodynamic Systems With Od</span></a></li><li class="astro-3ii7xxms"><a href="/papers/modeling-perception-and-cognition-using-monopoles-and-dipoles/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Modeling Perception and Cognition using Monopoles and Dipoles</span></a></li><li class="astro-3ii7xxms"><a href="/papers/observational-dynamics/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Observational Dynamics</span></a></li><li class="astro-3ii7xxms"><a href="/papers/observational-dynamics-objectives-for-information-theoretic-machine-learning/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Observational Dynamics Objectives For Information Theoretic Machine Learning</span></a></li><li class="astro-3ii7xxms"><a href="/papers/on-the-emergence-of-subjectivity/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">On The Emergence Of Subjectivity</span></a></li><li class="astro-3ii7xxms"><a href="/papers/optimizing-human-ai-interaction-with-od/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Optimizing Human Ai Interaction With Od</span></a></li><li class="astro-3ii7xxms"><a href="/papers/oscillations-information-and-integration-modeling-aspects-of-consciousness-with-tripolar-motifs/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Oscillations, Information, and Integration: Modeling Aspects of Consciousness with Tripolar Motifs</span></a></li><li class="astro-3ii7xxms"><a href="/papers/perceptual-frameworks/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Perceptual Frameworks</span></a></li><li class="astro-3ii7xxms"><a href="/papers/quantifying-inductive-biases-with-od/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Quantifying Inductive Biases With Od</span></a></li><li class="astro-3ii7xxms"><a href="/papers/quantifying-self-organization-and-interface-inductive-capacity-in-observational-dynamics-models-of-perception-and-consciousness/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Quantifying Self Organization And Interface Inductive Capacity In Observational Dynamics Models Of Perception And Consciousness</span></a></li><li class="astro-3ii7xxms"><a href="/papers/representing-datasets-as-energetic-environments-in-od/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Representing Datasets As Energetic Environments In Od</span></a></li><li class="astro-3ii7xxms"><a href="/papers/the-quantum-chinese-room-unraveling-the-paradox-of-machine-sentience/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">The Quantum Chinese Room   Unraveling The Paradox Of Machine Sentience</span></a></li><li class="astro-3ii7xxms"><a href="/papers/the-undifferentiated-plenum/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">The Undifferentiated Plenum</span></a></li><li class="astro-3ii7xxms"><a href="/papers/the-vibrational-biocosmosis-metabolism-as-inherent-in-the-fabric-of-reality/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">The Vibrational Biocosmosis   Metabolism As Inherent In The Fabric Of Reality</span></a></li><li class="astro-3ii7xxms"><a href="/papers/thermodynamics-of-perception/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Thermodynamics Of Perception</span></a></li><li class="astro-3ii7xxms"><a href="/papers/transferring-insights-between-biological-and-artificial-neural-networks-using-od/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Transferring Insights Between Biological And Artificial Neural Networks Using Od</span></a></li></ul></details></li><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">Reference</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">Observational Dynamics</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/applications-across-domains/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Applications Across Domains</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/circuit-analogies/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Circuit Analogies</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/diagrams/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Diagrams</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/discussion/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Discussion</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/environmental-replenishment/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Environmental Replenishment</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/impedance-factors/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Impedance Factors</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/information-theoretic-measures/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Information Theoretic Measures</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/mathematical-formalism/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Mathematical Formalism</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/modeling-simulation-and-analysis/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Modeling, Simulation and Analysis</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/paper/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">A Unified Framework for Modeling Awareness</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/simulations/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Simulations</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/symmetries-across-scales/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Symmetries Across Scales</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/the-observer-environment-model/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">The Observer-Environment Model</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-dynamics/thermodynamics-of-observation/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Thermodynamics of Observation</span></a></li></ul></details></li><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">Observational Network Dynamics</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><a href="/reference/observational-network-dynamics/computational-implementation/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Computational Implementation</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-network-dynamics/conclusion/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Conclusion</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-network-dynamics/connections-to-observational-dynamics-theory/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Connections to Observational Dynamics Theory</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-network-dynamics/introduction/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Introduction</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-network-dynamics/limitations-and-future-directions/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Limitations and Future Directions</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-network-dynamics/mathematical-framework/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Mathematical Framework</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-network-dynamics/paper/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Observational Network Dynamics</span></a></li><li class="astro-3ii7xxms"><a href="/reference/observational-network-dynamics/philosophical-implications/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Observational Network Dynamics - Philosophical Implications</span></a></li></ul></details></li><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">OD-OND</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><a href="/reference/od-ond/abstract/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Abstract</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/circuit-analogies/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Circuit Analogies</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/computational-methods/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Computational Methods</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/environmental-replenishment/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Environmental Replenishment</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/impedance-factors/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Impedance Factors</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/impedance-modeling/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Impedance Modeling</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/information-theoretic-measures/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Information-Theoretic Measures</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/introduction/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Introduction</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/mathematical-formalism/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Mathematical Formalism</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/network-models/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Network Models</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/observer-environment-model/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">The Observer-Environment Model</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/scale-transformation-laws/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Scale Transformation Laws</span></a></li><li class="astro-3ii7xxms"><a href="/reference/od-ond/thermodynamics-of-observation/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">The Thermodynamics of Observation</span></a></li></ul></details></li><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">Quantum</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><a href="/reference/quantum/qond/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Quantum Observational Network Dynamics</span></a></li><li class="astro-3ii7xxms"><a href="/reference/quantum/towards-a-unified-theory/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Towards a Unified Theory: Integrating Observational Dynamics with Quantum Phenomena</span></a></li></ul></details></li><li class="astro-3ii7xxms"><a href="/reference/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Reference Index</span></a></li><li class="astro-3ii7xxms"><a href="/reference/current-state-/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Towards a Unified Theory: Integrating Observational Dynamics with Quantum Phenomena</span></a></li><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">Trinitarian Transforms</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><a href="/reference/trinitarian-transforms/paper/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Trinitarian Transforms</span></a></li><li class="astro-3ii7xxms"><a href="/reference/trinitarian-transforms/state-changes/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">State Changes</span></a></li></ul></details></li><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">Water</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">devices</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"><li class="astro-3ii7xxms"><a href="/reference/water/devices/biological-ez-generator/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Biological EZ Generator</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/ez-water-batteries/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">EZ Water Batteries</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/ez-water-lubricant/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Vortex Water Lubricant</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/ez-water-reactor/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Bio-Inspired EZ Reactor</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/ez-water-seeding/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">EZ Water Seeding</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/ideas/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Ideas</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/vortex-desalinator/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Vortex Desalinator</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/vortex-hydroelectric-generator/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Vortex Hydroelectric Generator</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/vortex-mixing-heat-pump/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Vortex Mixing Heat Pump</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/vortex-propulsion-engine/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Vortex Propulsion Engine</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/devices/water-supercapacitor/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">EZ Water Supercapacitors</span></a></li></ul></details></li><li class="astro-3ii7xxms"><a href="/reference/water/ez-water-and-vortex-dynamics/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">EZ Water and Vortex Dynamics</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/ez-water-properties/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Exclusion Zone Water: Properties and Controversies</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/ez-water-vortex-motion/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Structured Water Dynamism: Examining Potential Connections Between Exclusion Zone Water and Schauberger Vortex Effects</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/papers/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Papers</span></a></li><li class="astro-3ii7xxms"><a href="/reference/water/viktor-schauberger/" class="astro-3ii7xxms"><span class="astro-3ii7xxms">Viktor Schauberger&#39;s Unorthodox Theories on Water Vortices</span></a></li></ul></details></li></ul></details></li><li class="astro-3ii7xxms"><details open class="astro-3ii7xxms"><summary class="astro-3ii7xxms"><span class="large astro-3ii7xxms">Machine Learning</span><svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></summary><ul class="astro-3ii7xxms"></ul></details></li></ul><div class="md:sl-hidden"><div class="mobile-preferences sl-flex astro-wu23bvmt"><starlight-theme-select><label style="--sl-select-width: 6.25em" class="astro-4yphtoen"><span class="sr-only astro-4yphtoen">Select theme</span><svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg><select value="auto" class="astro-4yphtoen"><option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option></select><svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg></label></starlight-theme-select><script>
	StarlightThemeProvider.updatePickers();
</script></div></div></div></div></nav><div class="main-frame astro-vrdttmbt"><div class="lg:sl-flex astro-67yu43on"><aside class="right-sidebar-container astro-67yu43on"><div class="right-sidebar astro-67yu43on"><div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"><li class="astro-g2bywc46" style="--depth: 0;"><a href="#_top" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">Overview</span></a></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#methods" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">Methods</span></a></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#distributed-architecture" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">Distributed Architecture</span></a><ul class="isMobile astro-g2bywc46" style="--depth: 1;"><li class="astro-g2bywc46" style="--depth: 1;"><a href="#modular-design" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Modular design</span></a></li><li class="astro-g2bywc46" style="--depth: 1;"><a href="#ensemble-methods" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Ensemble Methods</span></a></li><li class="astro-g2bywc46" style="--depth: 1;"><a href="#hierarchical-chaining" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Hierarchical Chaining</span></a></li><li class="astro-g2bywc46" style="--depth: 1;"><a href="#evolution" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Evolution</span></a></li><li class="astro-g2bywc46" style="--depth: 1;"><a href="#unified-model" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Unified Model</span></a></li></ul></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#using-ensemble-methods-to-create-a-composite-multi-agent-system-with-multiple-gpt-2-models" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">using ensemble methods to create a composite multi-agent system with multiple GPT-2 models</span></a></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#example-python-code" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">Example Python code</span></a></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#an-approach-to-implementing-an-agent-based-on-perceptual-control-theory-and-observational-dynamics" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">An approach to implementing an agent based on Perceptual Control Theory and Observational Dynamics</span></a></li></ul></div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"><li class="astro-g2bywc46" style="--depth: 0;"><a href="#_top" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">Overview</span></a></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#methods" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">Methods</span></a></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#distributed-architecture" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">Distributed Architecture</span></a><ul class="astro-g2bywc46" style="--depth: 1;"><li class="astro-g2bywc46" style="--depth: 1;"><a href="#modular-design" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Modular design</span></a></li><li class="astro-g2bywc46" style="--depth: 1;"><a href="#ensemble-methods" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Ensemble Methods</span></a></li><li class="astro-g2bywc46" style="--depth: 1;"><a href="#hierarchical-chaining" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Hierarchical Chaining</span></a></li><li class="astro-g2bywc46" style="--depth: 1;"><a href="#evolution" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Evolution</span></a></li><li class="astro-g2bywc46" style="--depth: 1;"><a href="#unified-model" class="astro-g2bywc46" style="--depth: 1;"><span class="astro-g2bywc46" style="--depth: 1;">Unified Model</span></a></li></ul></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#using-ensemble-methods-to-create-a-composite-multi-agent-system-with-multiple-gpt-2-models" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">using ensemble methods to create a composite multi-agent system with multiple GPT-2 models</span></a></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#example-python-code" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">Example Python code</span></a></li><li class="astro-g2bywc46" style="--depth: 0;"><a href="#an-approach-to-implementing-an-agent-based-on-perceptual-control-theory-and-observational-dynamics" class="astro-g2bywc46" style="--depth: 0;"><span class="astro-g2bywc46" style="--depth: 0;">An approach to implementing an agent based on Perceptual Control Theory and Observational Dynamics</span></a></li></ul></nav></starlight-toc></div></div></div></aside><div class="main-pane astro-67yu43on"><main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll"><div class="content-panel astro-7nkwcw3z"><div class="sl-container astro-7nkwcw3z"><h1 id="_top" class="astro-j6tvhyss">Composite Multi-Agent Systems</h1></div></div><div class="content-panel astro-7nkwcw3z"><div class="sl-container astro-7nkwcw3z"><div class="content astro-ml6ntd6l"><h2 id="methods">Methods</h2>
<h2 id="distributed-architecture">Distributed Architecture</h2>
<ul>
<li>Each GPT-2 model runs independently on separate hardware nodes in a distributed architecture. This allows concurrent parallel processing.</li>
<li>A central controller coordinates the models by routing inputs and outputs between them.</li>
<li>Communication protocols like gRPC can connect the nodes. Load balancing handles model distribution.</li>
</ul>
<h3 id="modular-design">Modular design</h3>
<ul>
<li>Break down the agent into logical modules (e.g. syntax, semantics, conversation etc). Assign specialist GPT-2 models to each module.</li>
<li>A core module integrates the outputs of other modules into a unified response.</li>
<li>Inter-module APIs and schemas allow seamless integration.</li>
</ul>
<h3 id="ensemble-methods">Ensemble Methods</h3>
<ul>
<li>Run multiple GPT-2 models with different hyper-parameters/training data.</li>
<li>Aggregate their outputs through ensembling approaches like weighted averages or voting.</li>
<li>Improves robustness over single models.</li>
</ul>
<h3 id="hierarchical-chaining">Hierarchical Chaining</h3>
<ul>
<li>Arrange models in a hierarchical DAG with lower level models feeding higher level ones.</li>
<li>Allows building up complexity from simple modules.</li>
<li>High level models integrate richer understanding of context.</li>
</ul>
<h3 id="evolution">Evolution</h3>
<ul>
<li>Evolve a population of agents with different GPT-2 model arrangements through selection and mutation.</li>
<li>Fitness based on coherence of agent’s responses.</li>
<li>Allows discovering ideal architectures</li>
</ul>
<h3 id="unified-model">Unified Model</h3>
<ul>
<li>Merge parameters from all models into a single large GPT-2 model.</li>
<li>Add module/task specific markers in input schema.</li>
<li>May run into size and overfitting issues.</li>
</ul>
<p>The overall architecture combines aspects of the above, tailored to requirements. The key is seamless integration of specialized modules into a unified agent interface.</p>
<h2 id="using-ensemble-methods-to-create-a-composite-multi-agent-system-with-multiple-gpt-2-models">using ensemble methods to create a composite multi-agent system with multiple GPT-2 models</h2>
<ul>
<li>
<p>Multiple GPT-2 models can be independently trained on the same data using different hyper-parameters (e.g. number of layers, attention heads, batch size etc) or on different subsets of the data.</p>
</li>
<li>
<p>During inference, the same input is fed to all models and their outputs are aggregated using an ensemble technique:</p>
</li>
<li>
<p>Simple Averaging: Take an unweighted average of model outputs.</p>
</li>
<li>
<p>Weighted Averaging: Assign weights to each model based on validation performance. Higher weight to better performing models.</p>
</li>
<li>
<p>Bayesian Model Averaging: Use Bayesian inference to estimate weights by treating them as probabilities.</p>
</li>
<li>
<p>Stacking: Feed model outputs as features into a meta-learner to generate the final output.</p>
</li>
<li>
<p>Voting: Models vote on the output; majority vote wins.</p>
</li>
<li>
<p>Ensemble methods improve robustness and stability compared to single models.</p>
</li>
<li>
<p>Weights can be dynamically adjusted to give higher influence to models specialized for the current context.</p>
</li>
<li>
<p>Multiple ensemble combinations can be maintained to generate diverse outputs.</p>
</li>
<li>
<p>Redundancy in models provides fault tolerance if some models fail.</p>
</li>
<li>
<p>Challenges include training complexity, inference cost, and reconciling inconsistent outputs.</p>
</li>
<li>
<p>Careful tuning of ensemble architecture, hyper-parameters, and combination method is required for optimal performance.</p>
</li>
</ul>
<p>In summary, ensembling provides a robust approach to integrate outputs from a collective of GPT-2 agents into a unified multi-agent system.</p>
<h2 id="example-python-code">Example Python code</h2>
<p>Here is some example Python code to illustrate a basic implementation of an ensemble of GPT-2 models:</p>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-comment)"># Train multiple GPT2 models with different hyperparameters/data</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">model_1 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> GPT2Model</span><span style="color:var(--astro-code-token-punctuation)">(hparams</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)">{...})</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">model_1</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">train</span><span style="color:var(--astro-code-token-punctuation)">(data_1)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">model_2 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> GPT2Model</span><span style="color:var(--astro-code-token-punctuation)">(hparams</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)">{...})</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">model_2</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">train</span><span style="color:var(--astro-code-token-punctuation)">(data_2)</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># Dictionary to hold models  </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">models </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)"> {</span><span style="color:var(--astro-code-token-string-expression)">'model_1'</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-color-text)"> model_1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'model_2'</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-color-text)"> model_2</span><span style="color:var(--astro-code-token-punctuation)">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># Model weights based on validation performance</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">weights </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)"> {</span><span style="color:var(--astro-code-token-string-expression)">'model_1'</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-constant)"> 0.6</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-string-expression)"> 'model_2'</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-constant)"> 0.4</span><span style="color:var(--astro-code-token-punctuation)">}</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># Ensemble prediction function</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">def</span><span style="color:var(--astro-code-token-function)"> ensemble_predict</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">input_text</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">  # Get individual model outputs</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  output_1 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> models</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-string-expression)">'model_1'</span><span style="color:var(--astro-code-token-punctuation)">].</span><span style="color:var(--astro-code-token-function)">predict</span><span style="color:var(--astro-code-token-punctuation)">(input_text)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  output_2 </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> models</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-string-expression)">'model_2'</span><span style="color:var(--astro-code-token-punctuation)">].</span><span style="color:var(--astro-code-token-function)">predict</span><span style="color:var(--astro-code-token-punctuation)">(input_text)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">  # Weighted average ensemble  </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  combined_output </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> weights</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-string-expression)">'model_1'</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">output_1 </span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)"> weights</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-string-expression)">'model_2'</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">output_2</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">  return</span><span style="color:var(--astro-code-color-text)"> combined_output</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)"># Sample usage  </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">output </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> ensemble_predict</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-string-expression)">"Hello world"</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">print</span><span style="color:var(--astro-code-token-punctuation)">(output)</span></span></code></pre>
<p>This shows:</p>
<ul>
<li>Training models separately</li>
<li>Storing them in a dictionary</li>
<li>Assigning heuristic weights</li>
<li>Making weighted ensemble predictions</li>
</ul>
<p>In practice, the models, combination logic, and weights can be much more sophisticated. But this demonstrates a simple ensemble approach.</p>
<h2 id="an-approach-to-implementing-an-agent-based-on-perceptual-control-theory-and-observational-dynamics">An approach to implementing an agent based on Perceptual Control Theory and Observational Dynamics</h2>
<pre class="astro-code css-variables" style="background-color:var(--astro-code-color-background);color:var(--astro-code-color-text); overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:var(--astro-code-token-comment)"># Import PyTorch for neural networks</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> torch </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> torch</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">nn </span><span style="color:var(--astro-code-token-keyword)">as</span><span style="color:var(--astro-code-color-text)"> nn</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> torch</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">optim </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> Adam</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">from</span><span style="color:var(--astro-code-color-text)"> torch</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">distributions </span><span style="color:var(--astro-code-token-keyword)">import</span><span style="color:var(--astro-code-color-text)"> Categorical</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">class</span><span style="color:var(--astro-code-token-function)"> PerceptionNet</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Module</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> __init__</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> input_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> hidden_size</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">        super</span><span style="color:var(--astro-code-token-punctuation)">(PerceptionNet, self).</span><span style="color:var(--astro-code-token-function)">__init__</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # CNN feature extraction layers</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">cnn </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Sequential</span><span style="color:var(--astro-code-token-punctuation)">(</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            nn.</span><span style="color:var(--astro-code-token-function)">Conv2d</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">32</span><span style="color:var(--astro-code-token-punctuation)">, kernel_size</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">, padding</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">),</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            nn.</span><span style="color:var(--astro-code-token-function)">ReLU</span><span style="color:var(--astro-code-token-punctuation)">(),</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            nn.</span><span style="color:var(--astro-code-token-function)">Conv2d</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">32</span><span style="color:var(--astro-code-token-punctuation)">, </span><span style="color:var(--astro-code-token-constant)">64</span><span style="color:var(--astro-code-token-punctuation)">, kernel_size</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">3</span><span style="color:var(--astro-code-token-punctuation)">, padding</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">),</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            nn.</span><span style="color:var(--astro-code-token-function)">ReLU</span><span style="color:var(--astro-code-token-punctuation)">(),</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            nn.</span><span style="color:var(--astro-code-token-function)">MaxPool2d</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">        )</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # RNN sequence modeling layers</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">rnn </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">LSTM</span><span style="color:var(--astro-code-token-punctuation)">(</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            input_size</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)">input_size, </span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            hidden_size</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)">hidden_size,</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            num_layers</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">, </span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">            batch_first</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">True</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">        )</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Attention mechanism</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">attention </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">MultiheadAttention</span><span style="color:var(--astro-code-token-punctuation)">(hidden_size, num_heads</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Initialize parameters</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">apply</span><span style="color:var(--astro-code-token-punctuation)">(self._init_weights)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> _init_weights</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> module</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        if</span><span style="color:var(--astro-code-token-function)"> isinstance</span><span style="color:var(--astro-code-token-punctuation)">(module, nn.Linear):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">init</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">xavier_uniform_</span><span style="color:var(--astro-code-token-punctuation)">(module.weight)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        elif</span><span style="color:var(--astro-code-token-function)"> isinstance</span><span style="color:var(--astro-code-token-punctuation)">(module, nn.LSTM):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">init</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">orthogonal_</span><span style="color:var(--astro-code-token-punctuation)">(module.weight_ih_l0)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">init</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">orthogonal_</span><span style="color:var(--astro-code-token-punctuation)">(module.weight_hh_l0)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> forward</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> x</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # CNN </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        x </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">cnn</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Flatten</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        x </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> x</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">reshape</span><span style="color:var(--astro-code-token-punctuation)">(x.</span><span style="color:var(--astro-code-token-function)">size</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">), </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # RNN</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">rnn</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Attention</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">attention</span><span style="color:var(--astro-code-token-punctuation)">(x, x, x)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> x</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">class</span><span style="color:var(--astro-code-token-function)"> PlanningNet</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Module</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> __init__</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> input_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> hidden_size</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">        super</span><span style="color:var(--astro-code-token-punctuation)">(PlanningNet, self).</span><span style="color:var(--astro-code-token-function)">__init__</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">lstm </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">LSTM</span><span style="color:var(--astro-code-token-punctuation)">(input_size, hidden_size, batch_first</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">True</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> forward</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> x</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">lstm</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">class</span><span style="color:var(--astro-code-token-function)"> MemoryNet</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Module</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">    </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> __init__</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> input_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> hidden_size</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">        super</span><span style="color:var(--astro-code-token-punctuation)">(MemoryNet, self).</span><span style="color:var(--astro-code-token-function)">__init__</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">attention </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">MultiheadAttention</span><span style="color:var(--astro-code-token-punctuation)">(input_size, num_heads</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">8</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> forward</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> x</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">attention</span><span style="color:var(--astro-code-token-punctuation)">(x, x, x)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">class</span><span style="color:var(--astro-code-token-function)"> ConceptionNet</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Module</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> __init__</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> input_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> hidden_size</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">        super</span><span style="color:var(--astro-code-token-punctuation)">(ConceptionNet, self).</span><span style="color:var(--astro-code-token-function)">__init__</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">planning_net </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> PlanningNet</span><span style="color:var(--astro-code-token-punctuation)">(input_size, hidden_size)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">memory_net </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> MemoryNet</span><span style="color:var(--astro-code-token-punctuation)">(input_size, hidden_size)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> forward</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> x</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        plan </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">planning_net</span><span style="color:var(--astro-code-token-punctuation)">(x)</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        memory </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">memory_net</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> plan</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> memory </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">class</span><span style="color:var(--astro-code-token-function)"> ActionNet</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Module</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> __init__</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> input_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> hidden_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> num_actions</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">        super</span><span style="color:var(--astro-code-token-punctuation)">(ActionNet, self).</span><span style="color:var(--astro-code-token-function)">__init__</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">lstm </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">LSTM</span><span style="color:var(--astro-code-token-punctuation)">(input_size, hidden_size, batch_first</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)">True</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">fc </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Linear</span><span style="color:var(--astro-code-token-punctuation)">(hidden_size, num_actions)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> forward</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> x</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">lstm</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        x </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">fc</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        prob </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">functional</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">softmax</span><span style="color:var(--astro-code-token-punctuation)">(x, dim</span><span style="color:var(--astro-code-token-keyword)">=-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        dist </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> Categorical</span><span style="color:var(--astro-code-token-punctuation)">(prob)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> dist</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">class</span><span style="color:var(--astro-code-token-function)"> MetaLearner</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Module</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> __init__</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> input_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> hidden_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> num_actions</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">        super</span><span style="color:var(--astro-code-token-punctuation)">(MetaLearner, self).</span><span style="color:var(--astro-code-token-function)">__init__</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">perception_net </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> PerceptionNet</span><span style="color:var(--astro-code-token-punctuation)">(input_size, hidden_size)</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">conception_net </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> ConceptionNet</span><span style="color:var(--astro-code-token-punctuation)">(hidden_size, hidden_size)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">action_net </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> ActionNet</span><span style="color:var(--astro-code-token-punctuation)">(hidden_size, hidden_size, num_actions)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> forward</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> x</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        p </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">perception_net</span><span style="color:var(--astro-code-token-punctuation)">(x)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        c</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> m </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">conception_net</span><span style="color:var(--astro-code-token-punctuation)">(p)</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        a </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">action_net</span><span style="color:var(--astro-code-token-punctuation)">(c)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> a</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> train</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> inputs</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> targets</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> optimizer</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        outputs </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> self</span><span style="color:var(--astro-code-token-punctuation)">(inputs)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        loss </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">CrossEntropyLoss</span><span style="color:var(--astro-code-token-punctuation)">(outputs, targets)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        loss</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">backward</span><span style="color:var(--astro-code-token-punctuation)">()</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        optimizer</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">step</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        optimizer</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">zero_grad</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">class</span><span style="color:var(--astro-code-token-function)"> PCDAgent</span><span style="color:var(--astro-code-color-text)">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> __init__</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> input_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> hidden_size</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> num_actions</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">meta_model </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> MetaLearner</span><span style="color:var(--astro-code-token-punctuation)">(input_size, hidden_size, num_actions)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">optimizer </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> Adam</span><span style="color:var(--astro-code-token-punctuation)">(self.meta_model.</span><span style="color:var(--astro-code-token-function)">parameters</span><span style="color:var(--astro-code-token-punctuation)">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">env </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> EnergyFlowEnv</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> sense</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> state</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        perception </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">meta_model</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">perception_net</span><span style="color:var(--astro-code-token-punctuation)">(state)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> perception</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> think</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> perception</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        conception</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">meta_model</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">conception_net</span><span style="color:var(--astro-code-token-punctuation)">(perception)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        action_dist </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">meta_model</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">action_net</span><span style="color:var(--astro-code-token-punctuation)">(conception)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> action_dist</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> act</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> action_dist</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        action </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> action_dist</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sample</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> action</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> learn</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> rewards</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        loss </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> compute_loss</span><span style="color:var(--astro-code-token-punctuation)">(rewards)</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">optimizer</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">zero_grad</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        loss</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">backward</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">optimizer</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">step</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> run_episode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        state </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">env</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">reset</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        while</span><span style="color:var(--astro-code-token-constant)"> True</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            perception </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">sense</span><span style="color:var(--astro-code-token-punctuation)">(state)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            action_dist </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">think</span><span style="color:var(--astro-code-token-punctuation)">(perception)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            action </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">act</span><span style="color:var(--astro-code-token-punctuation)">(action_dist)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            next_state</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> reward</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> done</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> _ </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">env</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">step</span><span style="color:var(--astro-code-token-punctuation)">(action)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">learn</span><span style="color:var(--astro-code-token-punctuation)">(reward)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">            if</span><span style="color:var(--astro-code-color-text)"> done</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">                break</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">                </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            state </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> next_state</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">class</span><span style="color:var(--astro-code-token-function)"> EnergyFlowEnv</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-function)">gym</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Env</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> __init__</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">      </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # 2D grid world</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid_size </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 20</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">zeros</span><span style="color:var(--astro-code-token-punctuation)">((self.grid_size, self.grid_size))</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Energy sources</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">sources </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> [(</span><span style="color:var(--astro-code-token-constant)">5</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 5</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-constant)">15</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 15</span><span style="color:var(--astro-code-color-text)">)] </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">source_energy </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 1000</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Energy pathways</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">pathways </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> [</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            ((</span><span style="color:var(--astro-code-token-constant)">5</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 10</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-constant)">10</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 10</span><span style="color:var(--astro-code-color-text)">))</span><span style="color:var(--astro-code-token-punctuation)">,</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            ((</span><span style="color:var(--astro-code-token-constant)">10</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 5</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-constant)">10</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 15</span><span style="color:var(--astro-code-color-text)">))</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        ]</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">pathway_capacity </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 400</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Agent</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_pos </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_energy </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 100</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Actions</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">action_space </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> spaces</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Discrete</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-constant)">4</span><span style="color:var(--astro-code-token-punctuation)">)</span><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # 0: wait, 1: left, 2: right, 3: up, 4: down</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Observations  </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">observation_space </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> spaces</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">Box</span><span style="color:var(--astro-code-token-punctuation)">(</span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">         0</span><span style="color:var(--astro-code-token-punctuation)">, </span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">         1000</span><span style="color:var(--astro-code-token-punctuation)">, </span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">         shape</span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)">(self.grid_size, self.grid_size)</span></span>
<span class="line"><span style="color:var(--astro-code-token-punctuation)">     )</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> step</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> action</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Apply action to move agent</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_pos </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> move</span><span style="color:var(--astro-code-token-punctuation)">(self.agent_pos, action)</span><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Energy dissipation over pathways</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        for</span><span style="color:var(--astro-code-color-text)"> path </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">pathways</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">            dissipate</span><span style="color:var(--astro-code-token-punctuation)">(path, self.pathway_capacity)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Energy radiation from sources </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        for</span><span style="color:var(--astro-code-color-text)"> source </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">sources</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">            radiate</span><span style="color:var(--astro-code-token-punctuation)">(source, self.grid, self.source_energy)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Agent energy absorption</span></span>
<span class="line"><span style="color:var(--astro-code-token-function)">        absorb</span><span style="color:var(--astro-code-token-punctuation)">(self.agent_pos, self.grid, self.agent_energy)</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Construct observation</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        obs </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> flatten_grid</span><span style="color:var(--astro-code-token-punctuation)">(self.grid)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Reward for agent energy </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        reward </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_energy</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        info </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-punctuation)"> {}</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        done </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> False</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> obs</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> reward</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> done</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> info</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)"> def</span><span style="color:var(--astro-code-token-function)"> reset</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Reset grid </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">zeros</span><span style="color:var(--astro-code-token-punctuation)">((self.grid_size, self.grid_size))</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Reset energy sources</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     for</span><span style="color:var(--astro-code-color-text)"> source </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">sources</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">         self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">source</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> =</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">source_energy </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Reset pathways</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     for</span><span style="color:var(--astro-code-color-text)"> path </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">pathways</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">         self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">path</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> =</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">pathway_capacity </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Reset agent  </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_pos </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-color-text)">) </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_energy </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-constant)"> 100</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Return initial observation</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     obs </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> flatten_grid</span><span style="color:var(--astro-code-token-punctuation)">(self.grid)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     return</span><span style="color:var(--astro-code-color-text)"> obs</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)"> def</span><span style="color:var(--astro-code-token-function)"> flatten_grid</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">grid</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     grid_size </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> len</span><span style="color:var(--astro-code-token-punctuation)">(grid)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     flattened </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> []</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(grid_size):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">         for</span><span style="color:var(--astro-code-color-text)"> j </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(grid_size):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">             flattened</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">append</span><span style="color:var(--astro-code-token-punctuation)">(grid[i][j])</span><span style="color:var(--astro-code-color-text)">         </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     flattened </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> np</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">array</span><span style="color:var(--astro-code-token-punctuation)">(flattened)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     return</span><span style="color:var(--astro-code-color-text)"> flattened</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)"> def</span><span style="color:var(--astro-code-token-function)"> move</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> current_pos</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> action</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> y </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> current_pos</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     if</span><span style="color:var(--astro-code-color-text)"> action </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-comment)"> #wait</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">         next_pos </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> y)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     elif</span><span style="color:var(--astro-code-color-text)"> action </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 1</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-comment)"> #left</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">         next_pos </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-function)">max</span><span style="color:var(--astro-code-token-punctuation)">(x</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">),</span><span style="color:var(--astro-code-color-text)"> y)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     elif</span><span style="color:var(--astro-code-color-text)"> action </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 2</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-comment)"> #right</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        next_pos </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-function)">min</span><span style="color:var(--astro-code-token-punctuation)">(x</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">,grid_size</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">),</span><span style="color:var(--astro-code-color-text)"> y)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     elif</span><span style="color:var(--astro-code-color-text)"> action </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 3</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-comment)"> #up</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">         next_pos </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-function)"> max</span><span style="color:var(--astro-code-token-punctuation)">(y</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">)</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     elif</span><span style="color:var(--astro-code-color-text)"> action </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 4</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-token-comment)"> #down</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">         next_pos </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> (x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-function)"> min</span><span style="color:var(--astro-code-token-punctuation)">(y</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">,grid_size</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">)</span><span style="color:var(--astro-code-color-text)">)</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     return</span><span style="color:var(--astro-code-color-text)"> next_pos</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)"> def</span><span style="color:var(--astro-code-token-function)"> dissipate</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> path</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> amount</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  start</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> end </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> path</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">  # Reduce grid energy along path</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  dx </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> end</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> -</span><span style="color:var(--astro-code-color-text)"> start</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  dy </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> end</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> -</span><span style="color:var(--astro-code-color-text)"> start</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">  for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(amount):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">   x </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> start</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-color-text)"> i</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">dx</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">   y </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> start</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-color-text)"> i</span><span style="color:var(--astro-code-token-keyword)">*</span><span style="color:var(--astro-code-color-text)">dy</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">   self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)">y</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> -=</span><span style="color:var(--astro-code-token-constant)"> 1</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)"> def</span><span style="color:var(--astro-code-token-function)"> radiate</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> source</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> grid</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> amount</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> y </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> source</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Radiate energy outwards from source</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-punctuation)">amount, amount</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">      for</span><span style="color:var(--astro-code-color-text)"> j </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-punctuation)">amount, amount</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">           # Don't radiate past grid bounds</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">           if</span><span style="color:var(--astro-code-color-text)"> (x</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">i </span><span style="color:var(--astro-code-token-keyword)">&#x3C;</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-keyword)"> or</span><span style="color:var(--astro-code-color-text)"> x</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">i </span><span style="color:var(--astro-code-token-keyword)">>=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid_size </span><span style="color:var(--astro-code-token-keyword)">or</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">               y</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">j </span><span style="color:var(--astro-code-token-keyword)">&#x3C;</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-keyword)"> or</span><span style="color:var(--astro-code-color-text)"> y</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">j </span><span style="color:var(--astro-code-token-keyword)">>=</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid_size)</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">               continue</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">           # Decay amount with Manhattan distance  </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">           manhattan_dist </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> abs</span><span style="color:var(--astro-code-token-punctuation)">(i)</span><span style="color:var(--astro-code-token-keyword)"> +</span><span style="color:var(--astro-code-token-function)"> abs</span><span style="color:var(--astro-code-token-punctuation)">(j)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">           radiation </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> amount </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-color-text)"> manhattan_dist</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">  </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">           # Add radiation to cell</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">           grid</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> y</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">j</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> +=</span><span style="color:var(--astro-code-color-text)"> radiation</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)"> def</span><span style="color:var(--astro-code-token-function)"> absorb</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> agent_pos</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> grid</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> amount</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)"> y </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> agent_pos</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Absorb energy from current cell</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     absorb_amount </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> min</span><span style="color:var(--astro-code-token-punctuation)">(amount, grid[x,y])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     grid</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)">y</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> -=</span><span style="color:var(--astro-code-color-text)"> absorb_amount</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_energy </span><span style="color:var(--astro-code-token-keyword)">+=</span><span style="color:var(--astro-code-color-text)"> absorb_amount</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Absorb leftover amount from adjacent cells</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     remaining </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> amount </span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-color-text)"> absorb_amount</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     for</span><span style="color:var(--astro-code-color-text)"> i </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">      for</span><span style="color:var(--astro-code-color-text)"> j </span><span style="color:var(--astro-code-token-keyword)">in</span><span style="color:var(--astro-code-token-function)"> range</span><span style="color:var(--astro-code-token-punctuation)">(</span><span style="color:var(--astro-code-token-keyword)">-</span><span style="color:var(--astro-code-token-constant)">1</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-constant)">2</span><span style="color:var(--astro-code-token-punctuation)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">          if</span><span style="color:var(--astro-code-color-text)"> (i </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-token-keyword)"> and</span><span style="color:var(--astro-code-color-text)"> j </span><span style="color:var(--astro-code-token-keyword)">==</span><span style="color:var(--astro-code-token-constant)"> 0</span><span style="color:var(--astro-code-color-text)">)</span><span style="color:var(--astro-code-token-punctuation)">:</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">     continue</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">          </span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">          if</span><span style="color:var(--astro-code-color-text)"> (</span><span style="color:var(--astro-code-token-constant)">0</span><span style="color:var(--astro-code-token-keyword)"> &#x3C;=</span><span style="color:var(--astro-code-color-text)"> x</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">i </span><span style="color:var(--astro-code-token-keyword)">&#x3C;</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid_size </span><span style="color:var(--astro-code-token-keyword)">and</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-constant)">              0</span><span style="color:var(--astro-code-token-keyword)"> &#x3C;=</span><span style="color:var(--astro-code-color-text)"> y</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">j </span><span style="color:var(--astro-code-token-keyword)">&#x3C;</span><span style="color:var(--astro-code-color-text)"> self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">grid_size)</span><span style="color:var(--astro-code-token-punctuation)">:</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            absorb_amount </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> min</span><span style="color:var(--astro-code-token-punctuation)">(remaining, grid[x</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-punctuation)">i,y</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-token-punctuation)">j])</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            grid</span><span style="color:var(--astro-code-token-punctuation)">[</span><span style="color:var(--astro-code-color-text)">x</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">i</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-color-text)">y</span><span style="color:var(--astro-code-token-keyword)">+</span><span style="color:var(--astro-code-color-text)">j</span><span style="color:var(--astro-code-token-punctuation)">]</span><span style="color:var(--astro-code-token-keyword)"> -=</span><span style="color:var(--astro-code-color-text)"> absorb_amount</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_energy </span><span style="color:var(--astro-code-token-keyword)">+=</span><span style="color:var(--astro-code-color-text)"> absorb_amount</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">            remaining </span><span style="color:var(--astro-code-token-keyword)">-=</span><span style="color:var(--astro-code-color-text)"> absorb_amount</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">     # Cap agent energy</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">     self</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-color-text)">agent_energy </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> min</span><span style="color:var(--astro-code-token-punctuation)">(self.agent_energy, </span><span style="color:var(--astro-code-token-constant)">1000</span><span style="color:var(--astro-code-token-punctuation)">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> compute_loss</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> rewards</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Compute loss based on rewards</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> loss</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> train</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> inputs</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> targets</span><span style="color:var(--astro-code-token-punctuation)">,</span><span style="color:var(--astro-code-token-parameter)"> optimizer</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Train meta-learner</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        outputs </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> self</span><span style="color:var(--astro-code-token-punctuation)">(inputs)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        loss </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-color-text)"> nn</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">CrossEntropyLoss</span><span style="color:var(--astro-code-token-punctuation)">(outputs, targets)</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        loss</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">backward</span><span style="color:var(--astro-code-token-punctuation)">()</span><span style="color:var(--astro-code-color-text)"> </span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        optimizer</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">step</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">        optimizer</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">zero_grad</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">    def</span><span style="color:var(--astro-code-token-function)"> run_episode</span><span style="color:var(--astro-code-color-text)">(</span><span style="color:var(--astro-code-token-parameter)">self</span><span style="color:var(--astro-code-color-text)">):</span></span>
<span class="line"><span style="color:var(--astro-code-token-comment)">        # Run episode</span></span>
<span class="line"><span style="color:var(--astro-code-token-keyword)">        return</span><span style="color:var(--astro-code-color-text)"> rewards</span></span>
<span class="line"></span>
<span class="line"><span style="color:var(--astro-code-color-text)">agent </span><span style="color:var(--astro-code-token-keyword)">=</span><span style="color:var(--astro-code-token-function)"> PCDAgent</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"><span style="color:var(--astro-code-color-text)">agent</span><span style="color:var(--astro-code-token-punctuation)">.</span><span style="color:var(--astro-code-token-function)">run_episode</span><span style="color:var(--astro-code-token-punctuation)">()</span></span>
<span class="line"></span></code></pre>
<p>This shows an end-to-end neural approach, with separate nets for each module integrated through a meta-learner. The environment is also a neural model trained along with the agent through RL. Many enhancements are possible here as well.</p></div><footer class="astro-3yyafb3n"><div class="meta sl-flex astro-3yyafb3n"></div><div class="pagination-links sl-flex astro-u2l5gyhi" dir="ltr"></div></footer></div></div></main></div></div></div></div></body></html>